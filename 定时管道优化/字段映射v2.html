<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ·»åŠ è¡¨ - é£ä¹¦å¼å¸åº•æµ®å±‚</title>
    <style>
        /* --- 1. åŸºç¡€é‡ç½® --- */
        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
            background: rgba(0,0,0,0.55); 
            height: 100vh; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            overflow: hidden; 
            color: #333;
        }

        /* å·¥å…·ç±» */
        .icon { width: 14px; height: 14px; fill: currentColor; vertical-align: middle; }
        .icon-md { width: 16px; height: 16px; }
        .text-gray { color: #999; }
        .text-blue { color: #1890ff; }
        .text-green { color: #52c41a; }
        .bg-blue-light { background-color: #e6f7ff; }
        .bg-green-light { background-color: #f6ffed; }

        /* --- 2. å¼¹çª—å®¹å™¨ --- */
        .modal-container { 
            width: 90%; height: 90%; background: #fff; border-radius: 4px; 
            box-shadow: 0 8px 24px rgba(0,0,0,0.2); display: flex; flex-direction: column; 
            min-width: 1100px; max-width: 1600px;
        }

        /* --- 3. å¤´éƒ¨ & æ­¥éª¤æ¡ --- */
        .modal-header { height: 50px; border-bottom: 1px solid #f0f0f0; display: flex; align-items: center; justify-content: space-between; padding: 0 24px; font-size: 16px; font-weight: 500; flex-shrink: 0; }
        .close-btn { font-size: 20px; color: #999; cursor: pointer; }

        .steps-bar { height: 48px; background: #fafafa; border-bottom: 1px solid #e8e8e8; display: flex; align-items: center; padding: 0 24px; flex-shrink: 0; font-size: 14px; }
        .step-item { display: flex; align-items: center; color: #999; margin-right: 20px; }
        .step-item.active { color: #333; font-weight: 500; }
        .step-badge { width: 20px; height: 20px; background: #d9d9d9; color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; margin-right: 8px; }
        .step-item.active .step-badge { background: #1890ff; }
        .step-arrow { margin-right: 20px; color: #ccc; }

        /* å…¨å±€æ“ä½œæ  */
        .global-actions-bar { height: 50px; background: #fff; display: flex; align-items: center; justify-content: flex-end; padding: 0 24px; flex-shrink: 0; }
        .global-batch-btn { height: 32px; padding: 0 16px; border: 1px solid #d9d9d9; background: #fff; border-radius: 2px; font-size: 14px; color: #333; cursor: pointer; display: flex; align-items: center; gap: 6px; transition: all 0.3s; }
        .global-batch-btn:hover { border-color: #40a9ff; color: #40a9ff; }

        /* --- 4. ä¸»ä½“å¸ƒå±€ --- */
        .modal-body { flex: 1; display: flex; overflow: hidden; position: relative; border-top: 1px solid #f0f0f0; }

        .sidebar { width: 240px; border-right: 1px solid #f0f0f0; display: flex; flex-direction: column; background: #fff; }
        .sidebar-search { padding: 16px; }
        .search-input { width: 100%; height: 32px; border: 1px solid #d9d9d9; border-radius: 2px; padding-left: 10px; }
        .tree-list { flex: 1; overflow-y: auto; padding-top: 10px; }
        .tree-node { padding: 10px 20px; cursor: pointer; font-size: 14px; }
        .tree-node.active { background: #e6f7ff; color: #1890ff; border-right: 2px solid #1890ff; }
        .resizer { width: 5px; cursor: col-resize; position: absolute; left: 240px; top: 0; bottom: 0; z-index: 10; }

        /* --- å³ä¾§æ»šåŠ¨è§†å£ --- */
        .content-viewport {
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            overflow-y: auto; /* æ ¸å¿ƒï¼šè¿™æ˜¯æ»šåŠ¨å®¹å™¨ */
            position: relative;
            background: #fff;
        }

        .content-padding { padding: 24px 24px 0 24px; } 

        .section-title { font-size: 16px; font-weight: bold; margin-bottom: 16px; color: #333; }

        /* --- [WRAPPER] åŒ…å«è¡¨å¤´ã€è¡¨æ ¼ã€æµ®åŠ¨æ¡çš„å®¹å™¨ --- */
        .table-section-wrapper {
            position: relative;
            display: flex;       /* ä½¿ç”¨ Flex å¸ƒå±€é˜²æ­¢ margin å¡Œé™· */
            flex-direction: column;
            border: 1px solid #e8e8e8;
            border-bottom: 0px; /* åº•éƒ¨è¾¹ç•Œç”± Floating Bar æˆ– Rows å¤„ç† */
        }

        /* 1. Sticky Header */
        .sticky-header-area { 
            position: sticky; top: 0; background: #fff; z-index: 20; 
            padding-bottom: 0;
            box-shadow: 0 2px 6px rgba(0,0,0,0.06); /* ç¨å¾®åŠ é‡é˜´å½±ä»¥ä¾¿åŒºåˆ† */
        }
        
        .toolbar-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; padding: 12px 12px 0 12px;}
        .split-header { display: flex; gap: 32px; margin-bottom: 2px; padding: 0 12px;}
        .header-box { flex: 1; height: 40px; display: flex; align-items: center; justify-content: space-between; padding: 0 12px; border-radius: 4px 4px 0 0; font-size: 13px; font-weight: bold; }
        .box-src { background: #e6f7ff; color: #333; }
        .box-tgt { background: #d9f7be; color: #333; }
        .target-config { display: flex; align-items: center; }
        .badge { background: #1890ff; color: #fff; font-size: 12px; padding: 1px 6px; border-radius: 2px; font-weight: normal; margin-right: 6px;}

        /* Col Header */
        .col-header { display: flex; background: #fafafa; border-top: 1px solid #e8e8e8; border-bottom: 1px solid #e8e8e8; font-size: 12px; color: #666; }
        .col-group { flex: 1; display: flex; height: 40px; align-items: center; }
        .col-gap { flex: 0 0 30px; }
        .th-chk { width: 40px; text-align: center; }
        .th-flex { flex: 1; padding-left: 8px; }
        .th-sm { width: 60px; text-align: center; }
        .th-op { width: 70px; text-align: center; }

        /* 2. Rows (è‡ªç„¶é«˜åº¦) */
        .rows-list { 
            background: #fff;
            min-height: 100px;
        }
        .table-row { display: flex; height: 50px; border-bottom: 1px solid #e8e8e8; align-items: center; font-size: 13px; }
        .table-row:hover { background: #fafafa; }
        .row-left, .row-right { flex: 1; display: flex; height: 100%; align-items: center; }
        .row-mid { flex: 0 0 30px; display: flex; justify-content: center; align-items: center; color:#ccc;}
        .row-input { height: 28px; width: 92%; border: 1px solid #d9d9d9; border-radius: 2px; padding:0 6px;}

        /* --- 3. [æ ¸å¿ƒ] é£ä¹¦å¼å¸åº•æµ®å±‚ (Sticky Bottom) --- */
        .feishu-bar-sticky {
            position: sticky; /* å…³é”®ï¼šå¸é™„å®šä½ */
            bottom: 0;        /* å¸é™„åœ¨è§†å£åº•éƒ¨ */
            z-index: 50;      /* å±‚çº§é«˜äºæ™®é€šè¡Œ */
            
            width: 100%;
            height: 56px;     /* æ ‡å‡†æ“ä½œæ é«˜åº¦ */
            background: #fff;
            
            /* é£ä¹¦é£æ ¼ï¼šä¸Šé˜´å½± + é¡¶éƒ¨è¾¹æ¡† */
            box-shadow: 0 -4px 12px rgba(0,0,0,0.08); 
            border-top: 1px solid #ebebeb;
            border-bottom: 1px solid #e8e8e8; /* é—­åˆè¡¨æ ¼åº•è¾¹ */

            /* åˆå§‹çŠ¶æ€ï¼šéšè— */
            display: none; 
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
        }

        .feishu-bar-sticky.active {
            display: flex; /* è¿™é‡Œåˆ‡æ¢ä¸º flex å³å¯è§¦å‘ Sticky è¡Œä¸º */
            animation: slideUpFade 0.3s ease-out;
        }

        @keyframes slideUpFade {
            from { transform: translateY(10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* æµ®å±‚å†…éƒ¨æ ·å¼ */
        .fb-left { display: flex; align-items: center; gap: 12px; }
        .minus-btn {
            width: 20px; height: 20px; background: #1890ff; color: #fff;
            border-radius: 2px; display: flex; align-items: center; justify-content: center;
            font-weight: bold; cursor: pointer;
        }
        .sel-text { font-size: 14px; color: #666; }
        .sel-num { font-weight: bold; color: #1890ff; margin: 0 4px; }

        .fb-right { display: flex; gap: 12px; }
        .fb-btn {
            height: 32px; padding: 0 16px; border: 1px solid #d9d9d9; border-radius: 4px;
            cursor: pointer; font-size: 14px; display: flex; align-items: center;
            background: #fff; transition: all 0.2s;
        }
        /* è“è‰²å¹½çµæŒ‰é’® */
        .fb-btn.primary { color: #1890ff; border-color: #d9d9d9; }
        .fb-btn.primary:hover { color: #1890ff; border-color: #1890ff; background: #e6f7ff; }
        /* çº¢è‰²å¹½çµæŒ‰é’® */
        .fb-btn.danger { color: #ff4d4f; border-color: #d9d9d9; }
        .fb-btn.danger:hover { color: #ff4d4f; border-color: #ff4d4f; background: #fff1f0; }

        /* --- 4. å†™å…¥æ–¹å¼ (æµå¼å¸ƒå±€åœ¨è¡¨æ ¼ä¸‹æ–¹) --- */
        .write-config-section { 
            margin-top: 40px; 
            padding: 24px; 
            border-top: 1px solid #f0f0f0; 
            margin-bottom: 20px; 
        }
        .cfg-row { display: flex; margin-bottom: 20px; font-size: 14px; }
        .cfg-label { width: 120px; color: #333; font-weight: 500; }
        .cfg-val { flex: 1; color: #333; display: flex; gap: 8px; flex-wrap: wrap; }
        .pk-tag { background: #fff; border: 1px solid #d9d9d9; border-radius: 4px; padding: 0 10px; height: 24px; display: flex; align-items: center; font-size: 13px; }

        /* Footer */
        .modal-footer { height: 64px; border-top: 1px solid #e8e8e8; background: #fff; display: flex; align-items: center; justify-content: flex-end; padding: 0 24px; flex-shrink: 0; z-index: 101;}
        .btn { height: 32px; padding: 0 16px; border: 1px solid #d9d9d9; background: #fff; border-radius: 2px; margin-left: 12px; cursor: pointer; font-size: 14px; }
        .btn:hover { color: #1890ff; border-color: #1890ff; }
        .btn-p { background: #1890ff; color: #fff; border-color: #1890ff; }

        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-thumb { background: #ccc; border-radius: 3px; }
    </style>
</head>
<body>

<div class="modal-container">
    <header class="modal-header">
        <span>æ·»åŠ è¡¨</span>
        <span class="close-btn">Ã—</span>
    </header>

    <div class="steps-bar">
        <div class="step-item"><span class="step-badge">1</span> é€‰æ‹©æ¥æºè¡¨</div>
        <span class="step-arrow">>></span>
        <div class="step-item active"><span class="step-badge">2</span> å­—æ®µæ˜ å°„ä¸å†™å…¥</div>
    </div>

    <!-- å…¨å±€è¡¨æ“ä½œ -->
    <div class="global-actions-bar">
        <div class="global-batch-btn">
            å…¨éƒ¨è¡¨æ‰¹é‡æ“ä½œ <span style="font-size:10px; margin-left:4px;">â–¼</span>
        </div>
    </div>

    <div class="modal-body">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-search"><input class="search-input" placeholder="æœç´¢è¡¨"></div>
            <div class="tree-list">
                <div class="tree-node active">ğŸ“… å…¥åº“å•æŸ¥è¯¢_å­è¡¨1</div>
                <div class="tree-node">ğŸ“… è´§å“ä»·ç›®è¡¨</div>
            </div>
        </div>
        <div class="resizer" id="resizer"></div>

        <!-- æ»šåŠ¨çš„å†…å®¹åŒº -->
        <div class="content-viewport">
            
            <div class="content-padding">
                <div class="section-title">å­—æ®µæ˜ å°„</div>

                <!-- ã€TABLE WRAPPERã€‘ å®šä¹‰äº† Sticky çš„ç”Ÿæ•ˆèŒƒå›´ -->
                <div class="table-section-wrapper">
                    
                    <!-- 1. è¡¨å¤´ (Sticky Top) -->
                    <div class="sticky-header-area">
                        <div class="toolbar-top">
                            <select style="height:32px; border:1px solid #ccc;"><option>åŒåæ˜ å°„</option></select>
                            <div style="font-size:14px; color:#666; cursor:pointer;">+ æ‰‹åŠ¨å»ºè¡¨ &nbsp; â†» é‡æ–°è·å–</div>
                        </div>

                        <div class="split-header">
                            <div class="header-box box-src">
                                <span><span class="badge">æ¥æº</span> é‡‡è´­å•æŸ¥è¯¢</span>
                                <span class="text-blue cursor-pointer">è¡¨å¤„ç†</span>
                            </div>
                            <div class="header-box box-tgt">
                                <div class="target-config">
                                    <span class="badge" style="background:#52c41a">ç›®æ ‡</span>
                                    <input value="è‡ªåŠ¨å»ºè¡¨: ç›®æ ‡è¡¨Tabe1" style="height:26px; border:1px solid #ccc; width:200px; padding:0 4px; font-size:12px;">
                                </div>
                                <span>â˜°</span>
                            </div>
                        </div>

                        <div class="col-header">
                            <div class="col-group bg-blue-light" style="border-right:1px solid #fff;">
                                <div class="th-chk"><input type="checkbox" id="checkAll"></div>
                                <div class="th-flex">æ¥æºè¡¨å­—æ®µ</div>
                                <div class="th-flex">ç±»å‹</div>
                                <div class="th-sm">ä¸»é”®</div>
                                <div class="th-sm">NotNull</div>
                            </div>
                            <div class="col-gap"></div>
                            <div class="col-group bg-green-light">
                                <div class="th-flex">ç›®æ ‡è¡¨å­—æ®µ</div>
                                <div class="th-flex">ç±»å‹</div>
                                <div class="th-sm">ç‰©ç†ä¸»é”®</div>
                                <div class="th-sm">NotNull</div>
                                <div class="th-flex">æ³¨é‡Š</div>
                                <div class="th-op"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 2. è¡¨æ ¼è¡Œ (è‡ªç„¶æµ) -->
                    <div class="rows-list" id="rowContainer"></div>

                    <!-- 3. ã€é£ä¹¦å¼å¸åº•æµ®å±‚ã€‘ Sticky Bottom -->
                    <!-- å…³é”®ï¼šå®ƒåœ¨ table-section-wrapper å†…ï¼Œè®¾ç½® sticky bottom: 0 -->
                    <div class="feishu-bar-sticky" id="stickyBar">
                        <div class="fb-left">
                            <div class="minus-btn" id="uncheckBtn" title="å–æ¶ˆå…¨é€‰">ï¼</div>
                            <span class="sel-text">å·²é€‰æ‹© <span class="sel-num" id="selCount">0</span> ä¸ªå­—æ®µ</span>
                        </div>
                        <div class="fb-right">
                            <button class="fb-btn primary">æ¢å¤æ˜ å°„</button>
                            <button class="fb-btn primary">ä¿®æ”¹ç±»å‹</button>
                            <button class="fb-btn danger">å–æ¶ˆæ˜ å°„</button>
                        </div>
                    </div>

                </div> <!-- End Table Wrapper -->
            
            </div> <!-- End Padding -->

            <!-- 4. å†™å…¥æ–¹å¼ (åœ¨Wrapperå¤–é¢ï¼Œè¿™æ ·Baræ»šåŠ¨åˆ°åº•éƒ¨æ—¶ä¼šâ€œæ¨â€ä¸Šå») -->
            <div class="write-config-section">
                <div class="section-title">å†™å…¥æ–¹å¼</div>
                <div style="border-bottom:1px solid #f0f0f0; margin-bottom:20px;"></div>
                <div class="cfg-row">
                    <span class="cfg-label">å†™å…¥æ–¹å¼</span>
                    <span class="cfg-val">ç›´æ¥å°†æ•°æ®å†™å…¥ç›®æ ‡è¡¨</span>
                </div>
                <div class="cfg-row">
                    <span class="cfg-label">ä¸»é”®æ˜ å°„ ?</span>
                    <span class="cfg-val" id="pkContainer"></span>
                </div>
                <div class="cfg-row">
                    <span class="cfg-label">ä¸»é”®å†²çªç­–ç•¥</span>
                    <span class="cfg-val">ä¸»é”®ç›¸åŒï¼Œè¦†ç›–ç›®æ ‡è¡¨æ•°æ®</span>
                </div>
            </div>

        </div>
    </div>

    <footer class="modal-footer">
        <button class="btn">å–æ¶ˆ</button>
        <button class="btn">ä¸Šä¸€æ­¥</button>
        <button class="btn btn-p">ç¡®å®š</button>
    </footer>
</div>

<script>
    // æ¨¡æ‹Ÿè¾ƒå¤šæ•°æ®ä»¥æ¼”ç¤ºæ»šåŠ¨æ•ˆæœ
    const fields = [
        { name: 'é‡‡è´­å•å·', type: 'number', key: true },
        { name: 'è®¾å¤‡åç§°', type: 'string' },
        { name: 'è§„æ ¼å‹å·', type: 'string' },
        { name: 'äº§å“ID', type: 'string', key: true },
        { name: 'åˆ›å»ºäºº', type: 'string' },
        { name: 'æ•°é‡', type: 'int' },
        { name: 'å¤‡æ³¨', type: 'text' },
        { name: 'å­—æ®µA', type: 'string' },
        { name: 'å­—æ®µB', type: 'string' },
        { name: 'å­—æ®µC', type: 'string' },
        { name: 'å­—æ®µD', type: 'string' },
        { name: 'å­—æ®µE', type: 'string' },
        { name: 'æ›´æ–°æ—¶é—´', type: 'datetime' },
        { name: 'çŠ¶æ€', type: 'int' },
        { name: 'ä»“åº“ID', type: 'string' }
    ];

    const rowContainer = document.getElementById('rowContainer');
    const pkContainer = document.getElementById('pkContainer');

    // æ¸²æŸ“è¡¨æ ¼
    function render() {
        let html = '';
        fields.forEach(f => {
            html += `
            <div class="table-row">
                <div class="row-left">
                    <div class="th-chk"><input type="checkbox" class="row-chk"></div>
                    <div class="th-flex">${f.name}</div>
                    <div class="th-flex text-gray">${f.type}</div>
                    <div class="th-sm">${f.key ? 'ğŸ”‘' : ''}</div>
                    <div class="th-sm"><input type="checkbox" disabled checked></div>
                </div>
                <div class="row-mid">âœ</div>
                <div class="row-right">
                    <div class="th-flex"><input class="row-input" value="${f.name}"></div>
                    <div class="th-flex"><input class="row-input" value="${f.type}"></div>
                    <div class="th-sm"></div>
                    <div class="th-sm"><input type="checkbox" checked></div>
                    <div class="th-flex text-gray">--</div>
                    <div class="th-op">ğŸ—‘ï¸</div>
                </div>
            </div>`;
        });
        rowContainer.innerHTML = html;
        pkContainer.innerHTML = fields.filter(f=>f.key).map(f=>`<div class="pk-tag">${f.name}=${f.name}</div>`).join('');
        bindEvents();
    }

    // ç»‘å®šäº¤äº’
    const stickyBar = document.getElementById('stickyBar');
    const selCount = document.getElementById('selCount');
    const checkAll = document.getElementById('checkAll');
    const uncheckBtn = document.getElementById('uncheckBtn');

    function bindEvents() {
        const checks = document.querySelectorAll('.row-chk');
        
        const update = () => {
            const n = Array.from(checks).filter(c=>c.checked).length;
            if (n > 0) {
                // å½“æœ‰é€‰ä¸­æ—¶ï¼Œæ·»åŠ  active ç±» -> display: flex -> sticky ç”Ÿæ•ˆ
                stickyBar.classList.add('active');
                selCount.innerText = n;
            } else {
                stickyBar.classList.remove('active');
            }
            checkAll.checked = (n === checks.length && n > 0);
            checkAll.indeterminate = (n > 0 && n < checks.length);
        }

        checks.forEach(c => c.addEventListener('change', update));
        checkAll.addEventListener('change', e => {
            checks.forEach(c => c.checked = e.target.checked);
            update();
        });
        uncheckBtn.addEventListener('click', () => {
            checks.forEach(c => c.checked = false);
            checkAll.checked = false;
            update();
        });
    }

    // Resize Logic
    const resizer = document.getElementById('resizer');
    const sidebar = document.getElementById('sidebar');
    let isResizing = false;
    resizer.addEventListener('mousedown', () => { isResizing = true; document.body.style.cursor='col-resize'; });
    document.addEventListener('mousemove', e => {
        if(isResizing) {
            const w = e.clientX - sidebar.parentElement.getBoundingClientRect().left;
            if(w > 150 && w < 500) sidebar.style.width = w + 'px';
        }
    });
    document.addEventListener('mouseup', () => { isResizing = false; document.body.style.cursor='default'; });

    render();
</script>
</body>
</html>